<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handmade Wonders | Order Now</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
    body { 
        font-family: 'Quicksand', sans-serif; 
        padding: 20px; 
        max-width: 500px; 
        margin: auto;
        background: linear-gradient(135deg, #f8c8dc 0%, #b298dc 100%);
        background-attachment: fixed;
        color: #4A4A4A; 
    }

    .page { 
        display: none; 
        background: rgba(255, 255, 255, 0.95);
        padding: 30px; 
        border-radius: 30px; 
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1); 
        border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .active { display: block; animation: fadeIn 0.5s; }
    
    @keyframes fadeIn { 
        from { opacity: 0; transform: translateY(15px); } 
        to { opacity: 1; transform: translateY(0); } 
    }

    h2 { 
        color: #7A5C91; 
        text-align: center; 
        font-weight: 700;
    }

    p { text-align: center; color: #666; }

    input { 
        width: 100%; 
        padding: 14px; 
        margin: 10px 0; 
        border: 2px solid #E0E0E0; 
        border-radius: 15px; 
        box-sizing: border-box;
        transition: 0.3s;
    }

    input:focus {
        border-color: #B298DC;
        outline: none;
        box-shadow: 0 0 8px rgba(178, 152, 220, 0.3);
    }

    button { 
        width: 100%; 
        padding: 16px; 
        margin: 10px 0; 
        background: #8E7AB5; 
        color: white; 
        border: none; 
        border-radius: 15px; 
        font-weight: 600; 
        font-size: 1.1em;
        cursor: pointer; 
        transition: 0.3s;
        box-shadow: 0 4px 15px rgba(142, 122, 181, 0.3);
    }

    button:hover { 
        background: #7A669E; 
        transform: scale(1.02); 
    }

    .back-btn { 
        background: #95B391 !important; 
        box-shadow: 0 4px 15px rgba(149, 179, 145, 0.3) !important;
    }

    .item { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        border-bottom: 1px solid #F0F0F0; 
        padding: 15px 0; 
    }

    .prod-img { 
        width: 65px; height: 65px; 
        border-radius: 15px; 
        margin-right: 15px; 
        object-fit: cover; 
        background: #D1D1D1;
        border: 2px solid #FFF;
        box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }

    .price-footer { 
        background: #fdfdfd; 
        border-top: 2px solid #EEE; 
        padding: 15px; 
        margin: 20px -30px -30px -30px; 
        border-radius: 0 0 30px 30px;
        display: flex; 
        justify-content: space-between; 
        align-items: center;
    }

    .total-amount { color: #7A5C91; font-weight: 700; font-size: 1.3em; }

    .error-text { color: #D9534F; font-size: 0.85em; display: none; margin-top: -5px; }
</style>
</head>
<body>

    <div id="page1" class="page active">
        <h2>Your Details</h2>
        <input type="text" id="custName" placeholder="Full Name">
        <input type="text" id="custId" placeholder="ID (202XXXXXXXXXG)">
        <div id="custIdError" class="error-text">Invalid ID format.</div>
        <input type="tel" id="custPhone" placeholder="10-Digit Phone">
        <div id="custPhoneError" class="error-text">Invalid Phone Number.</div>
        <button onclick="validatePage1()">Next: Shop Collection</button>
    </div>

    <div id="page2" class="page">
        <h2>Our Collection</h2>
        <p>Click images to view details</p>

        <div class="item">
            <div class="prod-info">
                <img src="images/placeholder.jpg" class="prod-img" onclick="openGallery(this.src)">
                <span><strong>Daisy Bracelet</strong><br><small>₹150</small></span>
            </div>
            <input type="checkbox" class="product" value="Daisy Bracelet (₹150)" data-price="150" onchange="updateTotal()">
        </div>

        <div class="item">
            <div class="prod-info">
                <img src="images/placeholder.jpg" class="prod-img" onclick="openGallery(this.src)">
                <span><strong>Crochet Bee</strong><br><small>₹250</small></span>
            </div>
            <input type="checkbox" class="product" value="Crochet Bee (₹250)" data-price="250" onchange="updateTotal()">
        </div>

        <div class="item">
            <div class="prod-info">
                <img src="images/placeholder.jpg" class="prod-img" onclick="openGallery(this.src)">
                <span><strong>Pastel Charm</strong><br><small>₹120</small></span>
            </div>
            <input type="checkbox" class="product" value="Pastel Charm (₹120)" data-price="120" onchange="updateTotal()">
        </div>

        <div class="price-footer">
            <span>Items Selected</span>
            <span class="total-amount">Total: ₹<span id="liveTotal">0</span></span>
        </div>

        <button onclick="validatePage2()">Next: Delivery</button>
        <button onclick="nextPage(1)" style="background:#B2CEFE">Back</button>
    </div>

    <div id="page3" class="page">
        <h2>Delivery Info</h2>
        <input type="text" id="recName" placeholder="Recipient Name">
        <input type="text" id="recId" placeholder="Recipient ID/Room (202...G)">
        <div id="recIdError" class="error-text">Invalid ID format.</div>
        <input type="tel" id="recPhone" placeholder="Recipient Phone">
        <div id="recPhoneError" class="error-text">Invalid Phone Number.</div>
        <button id="confirmBtn" onclick="validateAndSubmit()">Confirm Order</button>
        <button onclick="nextPage(2)" style="background:#B2CEFE">Back</button>
    </div>

    <div id="success" class="page">
        <div style="text-align: center;">
            <h2 style="color: #B2CEFE;">Order Placed!</h2>
            <p>Thank you for placing order!</p>
            <button onclick="location.reload()">New Order</button>
        </div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwllzgyizcL7TgocbOjO4L5umqAosWOe8tc_f8zycIbcJhnB6Q1KN0m51dr_jIgSZBi8w/exec';
        const idRegex = /^202[a-zA-Z0-9]{9}G$/i; 
        const phoneRegex = /^[0-9]{10}$/;

        function nextPage(pageNo) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page' + pageNo).classList.add('active');
        }

        function updateTotal() {
            let total = 0;
            const selected = document.querySelectorAll('.product:checked');
            selected.forEach(item => {
                total += parseInt(item.getAttribute('data-price'));
            });
            document.getElementById('liveTotal').innerText = total;
        }

        function openGallery(src) {
            if(src.includes('placeholder')) {
                alert("Image gallery will open here once you add your photos!");
            } else {
                window.open(src, '_blank'); 
            }
        }

        function validatePage1() {
            const id = document.getElementById('custId').value;
            const phone = document.getElementById('custPhone').value;
            let ok = true;
            if(!idRegex.test(id)) { document.getElementById('custIdError').style.display='block'; ok=false; }
            if(!phoneRegex.test(phone)) { document.getElementById('custPhoneError').style.display='block'; ok=false; }
            if(ok) nextPage(2);
        }

        function validatePage2() {
            if(document.querySelectorAll('.product:checked').length > 0) nextPage(3);
            else alert("Please select at least one item!");
        }

        function validateAndSubmit() {
            const id = document.getElementById('recId').value;
            const phone = document.getElementById('recPhone').value;
            if(idRegex.test(id) && phoneRegex.test(phone)) submitOrder();
            else alert("Please check delivery details!");
        }

        async function submitOrder() {
            const btn = document.getElementById('confirmBtn');
            btn.innerText = "Sending...";
            btn.disabled = true;

            const selected = Array.from(document.querySelectorAll('.product:checked')).map(p => p.value).join(", ");
            const data = {
                name: document.getElementById('custName').value,
                id: document.getElementById('custId').value,
                phone: document.getElementById('custPhone').value,
                items: selected + " | Total: ₹" + document.getElementById('liveTotal').innerText,
                rName: document.getElementById('recName').value,
                rId: document.getElementById('recId').value,
                rPhone: document.getElementById('recPhone').value
            };

            try {
                await fetch(SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(data) });
            } finally {
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.getElementById('success').classList.add('active');
            }
        }
    </script>
</body>
</html>